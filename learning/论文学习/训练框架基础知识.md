# 1

## 11

人物重新识别（re-ID）旨在匹配从非重叠的摄像机网络中收集的图像库中的人物，由于其在安全和监视中的广泛应用，这引起了人们越来越多的兴趣。尽管有监督的再识别方法（Yang et al.，2020）（Zheng等人，2016）已经取得了非常不错的结果，但它们在很大程度上依赖于足够的数据和昂贵的手动注释，这也需要大量的个人身份信息，并带来隐私问题。相比之下，无监督的重新识别不仅降低了标记成本，而且在不手动检查图像的情况下保护了个人隐私。通常，根据是否使用额外标记的数据，无监督re-ID可分为两类：无监督领域自适应（UDA）（Zhai et al.，2020a）（Zhong et al.，2020）和完全无监督re-ID（FU）（Chen et al.，2021）（Lin et al.，2019）。在这项研究中，我们将主要关注直接学习的完全无监督设置.

为了应对无监督re-ID的挑战，最近的努力集中在通过自我完善策略训练个体神经网络（Song et al.，2018）（Ge et al.，2020b）。他们试图通过聚类算法（Caron等人，2018）或图神经网络（Ye等人，2017），基于自预测的伪标签来学习更好的表示。然而，单个模型只能使用这样的自学习机制来增强其现有的辨别能力，而不能处理错误预测的伪标签，这使其无法最大限度地提高辨别能力。由于单一模型缺乏多样性，不正确的伪标签在无监督训练后可能保持不变，例如不同人的图像被聚类到同一组的假阳性样本或同一人的图像聚类到不同组的假阴性样本，如图所示。1。重要的是，由于模型学习了不同架构的不同区分，一个模型预测的不正确伪标签可以由另一个模型正确预测，如图中的方框所示。第1（b）段。在本文中，我们试图通过多模型训练来解决无监督的re-ID问题，在多模型训练中，不同模型的互补信息可以被有效地整合和利用，以探索未标记数据中包含的各种潜在知识（定量分析如第4.4.1节所示）。

然而，多模式训练仍然面临两个具有挑战性的问题：（1）如何在多个不同的模式下学习多样性歧视？（2） 如何从众多不同的模型中选择一组更好的模型进行训练？为了解决这些问题，我们提出了一种基于种群的进化博弈（PEG），通过探索和利用其多样性来选择和训练有区别的模型。PEG通过神经网络的迭代选择、繁殖、突变和群体互学习同时训练一组模型，如图所示。2。具体而言，选择通过选择并保留具有互补判别能力的网络的最优子集，同时放弃该子集之外的其他网络，使整个群体适应未标记的数据。这种网络在选择中的组合优化被建模为多智能体合作博弈，并通过最佳响应动力学来解决，其中每个智能体试图学习对其他智能体行动的最佳响应，从而导致纳什均衡。然后，对选定的种群进行繁殖和突变，通过对每个网络进行多个拷贝并对其超参数施加随机扰动来增加其多样性。选择和繁殖共同维持着种群的规模。然后，在网络之间进行群体相互学习，通过知识提炼来组装和进一步探索群体内部的辨别能力。每个网络从群体共享的伪标签和其他单独网络预测的软标签中学习表示。进化博弈过程利用周期性的选择、繁殖和突变、群体相互学习，使神经网络的有利特征和知识能够代代相传。

在进化游戏中，一个核心问题是定义游戏的效用函数，即进化中网络选择的标准。然而，没有标记数据集的CNN模型的评估还没有得到很好的研究。在这里，我们提出了交叉参考散射（CRS），它可以使用未标记的样本近似评估网络的质量。通常，由更好的网络预测的伪标签更准确；然而，当无法获得地面实况时，无法直接评估其准确性。此外，由更准确的伪标签训练的模型往往在特征空间中实现更大的簇内内聚和簇间分离，因为不正确的标签将强制模型分离同一类的样本或聚合不同类的样本。

受这一现象的启发，我们根据由被评估网络的伪标签训练的参考模型的特征内聚和分离来间接评估网络。因此，CRS由特征的聚类间方差和聚类内方差的比率来定义，以测量分离和内聚。我们证明，CRS近似地反映了没有基本事实数据的模型的判别能力，从而促进了进化博弈学习更好的表示。

这项工作的初步版本已经部分发表（Zhai et al.，2020c），证明了在无监督条件下多个网络之间相互学习的有效性。在该版本的基础上，本文进行了很大的改进，包括：1）我们提出了一种新的基于群体的进化博弈（PEG）框架（第3.1节）。以前的算法只在给定的网络上被动工作，不能从模型库中自适应地选择最合适的模型。在相互学习的基础上，PEG还通过多智能体合作博弈包含了网络的迭代选择，防止弱网络分散整体辨别能力（第3.1.1节）。2）我们提出了一种新的交叉参考散射（CRS）来近似测量没有标记数据的re-ID模型。为了评估模型的区分性，以前的版本引入了簇间/簇内分散，以在相互学习过程中大致调整模型的权重。

这项工作的初步版本已经部分发表（Zhai et al.，2020c），证明了在无监督条件下多个网络之间相互学习的有效性。在该版本的基础上，本文进行了很大的改进，包括：1）我们提出了一种新的基于群体的进化博弈（PEG）框架（第3.1节）。以前的算法只在给定的网络上被动工作，不能从模型库中自适应地选择最合适的模型。在相互学习的基础上，PEG还通过多智能体合作博弈包含了网络的迭代选择，防止弱网络分散整体辨别能力（第3.1.1节）。2）我们提出了一种新的交叉参考散射（CRS）来近似测量没有标记数据的re-ID模型。为了评估模型的区分性，以前的版本引入了簇间/簇内分散，以在相互学习过程中大致调整模型的权重。

然而，由于缺乏准确评估模型的能力，它不能被视为PEG中合作博弈的效用函数。本文通过添加交叉参考评估（CR）方案将簇间/簇内散射改进为交叉参考散射（第3.1.1节）。3）进行了更多的定性和定量实验来评估该方法的有效性，包括但不限于CRS、合作博弈和PEG的验证和分析。

主要内容：
-它提出了一种新的基于群体的进化博弈框架，用于无监督的人再识别，该框架通过迭代选择、繁殖、突变和相互学习来训练不同的神经网络群体。

–它引入了一种多智能体合作游戏来选择PEG中的网络，旨在在未标记的数据上找到并保存种群的最优子集。

–它研究了使用未标记数据对re-ID模型的评估，并提出了交叉参考散射，该散射通过根据特征空间的内聚和分离间接估计其预测的伪标签来近似测量模型的辨别能力。

–实验表明，PEG在大规模数据集上优于最先进的方法，这表明基于人群的多模型训练具有巨大潜力。

## 2
### 2.1 Unsupervised Person Re-ID

无监督人员再识别可分为无监督领域自适应（UDA）和完全无监督再识别（FU）。UDA方法试图通过未标记的目标数据和标记的源数据来训练re-ID模型，而FU方法试图在预训练后仅使用未标记的数据来训练模型。尽管数据条件不同，但大多数UDA和FU方法都采用了相似的学习策略，可以概括为两类。一系列工作主要基于对齐，以减少像素级相机或域之间的分布偏移，如SPGAN（Deng et al.，2018）、CamStyle（Zhong et al.，2019b）、HHL（Zhong等人，2018），ECN（Zhong等，2019a）、ATNet（Liu et al.，2019）、PDA-Net（Li et al.，2029b），DG-Net++（Zou等人，2020）和GCL（Chen等人，2021b），或特征级，如TJ-AIDL（Wang et al.，2018）、DAAM（Huang et al.，2019）、UCDACCE（Qi et al.，2017）、IICS（Xuan and Zhang，2021）和CAP（Wang et al，2020a）。这一系列方法充分利用了相机或领域风格的可靠信息，但忽略了未标记样本之间的潜在关系，这阻碍了它们获得更好的性能。

另一系列工作基于伪标签发现，其依赖于伪标签挖掘和模型微调的迭代（Fan et al.，2018）（Song et al.，18）（Zhang et al.（2019）（Jin et al.（2020））（赵et al.，2020）（Zheng et al.），2021b），如BUC（Lin et al。最近的工作主要集中在标签生成、标签精炼、额外信息的辅助和表示的优化。BUC（Lin et al.，2019）提出了一种自下而上的聚类方法来生成伪标签。为了减少伪标签噪声，DCML（Chen et al.，2020）选择了可信的训练样本，MMT（Ge et al.，2020a）提出了一种用于更好的伪标签的互学习方案。JVTC（Li和Zhang，2020）和CycAs（Wang et al.，2020b）探索时间信息来细化视觉相似性。具有特征记忆库的对比学习在许多工作中被广泛用于学习更鲁棒的表示（Zheng et al.，2021a）（Chen et al.，2021）。SpCL（Ge等人，2020b）逐渐生成了更可靠的聚类，用于统一的对比损失。聚类对比度（Dai et al.，2021）提出在聚类水平上存储特征向量并计算对比度损失。尽管已经取得了巨大的成功，但这一系列方法通常利用单一的模型来学习它已经掌握的知识，由于缺乏多样性的歧视，很难学习到足够的能力。为了缓解这个问题，我们提出了基于多模型训练的PEG，其中可以通过网络的进化来探索和利用歧视的多样性。




2.2多模型集成以前有大量关于神经网络集成的工作。显式集成方法通常训练一系列基层网络，并将其预测平均作为最终结果，这在训练和测试过程中效率较低（Hansen和Salamon，1990）（Perrone和Cooper，1992）（Krogh和Vedelsby，1994）（Dietterich，2000）（Huang等人，2017a）（Lakshminarayanan等人，2017）。最近，隐式集成方法被探索来解决这个问题。一种典型的方法（Srivastava et al.，2014）、（Wan et al.，2013）、（Huang et al.，2016）、（Singh等人，2016）通常在训练期间创建一系列具有共享权重的网络，然后在测试时隐式地对其进行集成。另一种方法（Shen et al.，2019）侧重于标签精炼，通过从各种经过训练的网络中提取知识并将其转移到单个网络中，以获得更高的辨别能力。然而，这些有监督的方法不能直接用于无监督的re-ID任务，尤其是当训练集和测试集共享非重叠的标签空间时。另一方面，现有的方法在所有基层网络上实现了集成，而忽略了一个非常弱的基层网络在被包括在内时可能会降低整体性能的问题。通常，“全部”并不是“最佳”。在这项工作中，我们在框架的选择阶段提出了一种合作对策，以使用未标记的数据来寻找和保持基层网络的最佳组合，并在无监督条件下通过迭代种群进化对策获得渐进集成。



2.3算法博弈论提出了具有多智能体博弈的机器学习方法来解决各种任务，如图像生成（Goodfellow et al.，2014）、深度学习的攻击和防御（Yuan et al.，2019）、玩计算机游戏（Vinyals et al.，2019）（Peng et al.，2020）等。SVM可以被认为是两个代理之间的游戏，其中一个代理在提供了最难分类的点之后挑战另一个代理来找到最佳超平面。生成对抗性网络（GANs）（Goodfellow等人，2014）对鉴别器和生成器这两个网络进行相互训练，以生成可以传递真实数据的图像。这些方法是为代理具有相反奖励的非合作游戏设计的。然而，在这项工作中，网络的选择被建模为一个多智能体合作游戏，其中奖励是全局的，由所有智能体共享。尽管合作游戏的方法已经被探索用于强化学习（Peng et al.，2020），但它们不能用于这样的计算机视觉任务。我们的方法考虑了合作博弈论中的最佳响应动力学来解决模型选择策略的纳什均衡问题。

2.4模型的无监督评估度量亲自重新识别使用的度量总是取决于具有基本事实的样本，例如在模型预测和相应的基本事实标签之间计算的平均精度（mAP）和累积匹配特征（CMC）曲线。然而，当数据标签未知时，这些有监督的度量在无监督学习过程中不可用，因此，它们不能用作我们PEG框架中模型选择的标准。另一方面，已经设计了几个不需要数据标签的无监督评估指标来作为内部评估指标来测量聚类算法的性能（Davies和Bouldin，1979）（Baker和Hubert，1975）（Hubert和Levin，1976）（Maulik和Bandyopadhyay，2002）（Halkidi等人，2002）。例如，轮廓系数（Rousseeuw，1987）估计一个聚类中的每个点与最近相邻聚类中的点之间的平均距离。Dunn指数（Dunn，1973）计算样本之间簇间距离的最小值与簇内距离的最大值的比率。然而，这些聚类验证不能直接用于评估re-ID模型，例如，在相同的聚类算法下，通过其提取特征的聚类质量。这是因为特征聚类的分布无法衡量模型的性能，尤其是在无监督的环境中。例如，即使模型很差，度量也可以很好地估计特征的聚类，但仅被训练为对其不准确的标签进行过拟合。在本文中，我们提出了一种交叉参考散射，它通过间接估计模型预测的伪标签来近似测量模型的判别能力。它利用伪标签来训练参考网络进行几次迭代，然后观察其特征空间的内聚性和分离性，以估计评估模型的判别力。该方法挖掘图像样本之间潜在的视觉关系，从而可以近似估计模型对未标记数据的辨别力。2.5基于种群的进化训练基于种群的演化已被广泛研究以解决实值优化问题。对于距离度量学习，提出了re-ID、EDML（Fukui et al.，2013）及其变体（Kalintha et al.，2019）（Ali et al.，2020）的相关任务，以使用差分进化优化线性或非线性变换。然而，由于可学习参数的规模很大，这些方法无法解决深度神经网络在re-ID中的训练问题。我们的方法受到了另一种基于人口的训练（PBT）（Jaderberg et al.，2017）的启发，并建立在该训练的基础上，该训练最初是为优化网络的超参数而提出的。PBT训练大量网络，并定期执行开发和探索过程，从而自动学习最佳配置。它已被证明对一系列具有挑战性的问题有效，包括强化学习的Atari和StarCraft II（Vinyals等人，2019）（Jaderberg et al.，2019）、训练生成对抗网络（GAN）（Jader berg et al.。，2017）和数据扩充（Ho et al.，2017）。然而，这种基于人群的网络训练尚未在无监督条件下进行探索，在这种条件下，网络选择的标准很难确定。另一方面，现有的PBT方法遵循最佳个体选择的原则，而我们的方法选择并保留了更具互补性的最佳网络组。我们还将群体内的相互学习纳入了框架中，从而在无监督的re-ID上获得了卓越的性能。
